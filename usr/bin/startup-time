#!/bin/bash

STARTUP_TIME_FILE="/var/lib/startup-time.state"

delete_time() {
    if [ -f "$STARTUP_TIME_FILE" ]; then
        rm "$STARTUP_TIME_FILE"
        echo "Deleted startup time."
    else
        echo "No startup time set."
    fi
}

set_time() {
    DATE_STRING="$*"
    STARTUP_TIME=$(date -d "$DATE_STRING" --utc +%Y-%m-%dT%H:%M:%SZ)
    if [ $? -eq 0 ]; then
        echo "$STARTUP_TIME" > "$STARTUP_TIME_FILE"
        echo "Set startup time to $STARTUP_TIME"
    else
        echo "Invalid date format provided."
    fi
}

if [ "$1" == "delete" ]; then
    delete_time
elif [ "$1" == "set" ] && [ -n "$2" ]; then
    shift
    set_time "$@"
else
    echo "Usage:"
    echo "  startup-time delete              "
    echo "  startup-time set '<date_string>' "
fi
